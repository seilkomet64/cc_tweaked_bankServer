local a={}local b=require("itemManager")local function c(d,e,f)fs.delete("account/"..d)local g=fs.open("account/"..d,"w")g.writeLine(e)g.writeLine(f)g.close()end;function a.deposit(d,h,f)local g=fs.open("account/"..d,"r")if g~=nil then local i=tonumber(g.readLine())local j=i;local k=g.readLine()g.close()if f==k then local l,m=pcall(function()return b.materializeItems(h)end)if not l then local n=m:match(":%d+: (.+)")or m;if n=="Bank is full!"then return false,n else print(m)return false,"Unknown Server Error"end else j=j+m*CONFIG.EXCHANGERATE;c(d,j,k)return true,j,i end else return false,"Incorrect Pin"end end end;function a.withdraw(d,o,f)local g=fs.open("account/"..d,"r")if g~=nil then local j=tonumber(g.readLine())local k=g.readLine()g.close()if f==k then if j>=o then local l,m=pcall(function()return b.digitizeAmount(o)end)if not l then local n=m:match(":%d+: (.+)")or m;if n=="Bank is too poor!"then return false,n else print(m)return false,"Unknown Server Error"end else j=j-o;c(d,j,k)return true,m,j end else return false,"Insufficient Funds"end else return false,"Incorrect Pin"end end end;function a.getBalance(d,f)local g=fs.open("account/"..d,"r")if g~=nil then local j=tonumber(g.readLine())local k=g.readLine()g.close()if f==k then return true,j else return false,"Incorrect Pin"end end end;function a.transfer(d,o,p,f)if d==p then return false,"Cannot transfer to the same account"end;local g=fs.open("account/"..d,"r+")local q=fs.open("account/"..p,"r+")if g~=nil and q~=nil then local j=tonumber(g.readLine())local k=g.readLine()local r=tonumber(q.readLine())local s=q.readLine()if f==k then if j>=o then j=j-o;r=r+o;c(d,j,k)c(d,r,s)g.close()q.close()return true,j else return false,"Insufficient Funds"end else return false,"Incorrect Pin"end end end;function a.checkPin(d,f)local t=false;if not d or not f then return t end;local g=fs.open("account/"..d,"r+")if g~=nil then local j=tonumber(g.readLine())local k=g.readLine()if f==k then t=true end;g.close()return t else return false end end;function a.checkCard(d)local t=false;if not d then return t end;local g=fs.open("account/"..d,"r")if g~=nil then t=true;g.close()end;return t end;function a.createAccount(d,f)if not d or not f then return false,"Account number and PIN are required"end;local g=nil;g=fs.open("account/"..d,"r")if g~=nil then g.close()return false,"Account already exists"end;local e=0;g=fs.open("account/"..d,"w")g.writeLine(e)g.writeLine(f)g.close()return true,"Account created successfully"end;return a
